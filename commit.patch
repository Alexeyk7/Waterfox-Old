# HG changeset patch
# User Alex Kontos <alex@waterfoxproject.org>
# Date 1484923074 0
#      Fri Jan 20 14:37:54 2017 +0000
# Node ID 4bef188995a734fa0561a6a4e978a42c9663598f
# Parent  9a5e1a8c8ebb4fe61386fadb6c52464430e58c54
Changes

diff -r 9a5e1a8c8ebb -r 4bef188995a7 .gitignore
--- a/.gitignore	Fri Jan 20 03:08:48 2017 -0800
+++ b/.gitignore	Fri Jan 20 14:37:54 2017 +0000
@@ -18,8 +18,8 @@
 **/.dir-locals.el
 
 # User files that may appear at the root
-/.mozconfig*
-/mozconfig
+/.rej
+/.orig
 /configure
 /old-configure
 /config.cache
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/app/macbuild/Contents/Info.plist.in
--- a/browser/app/macbuild/Contents/Info.plist.in	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/app/macbuild/Contents/Info.plist.in	Fri Jan 20 14:37:54 2017 +0000
@@ -143,7 +143,7 @@
 		</dict>
 	</array>
 	<key>CFBundleExecutable</key>
-	<string>firefox</string>
+	<string>waterfox</string>
 	<key>CFBundleGetInfoString</key>
 	<string>%MAC_APP_NAME% %APP_VERSION%</string>
 	<key>CFBundleIconFile</key>
@@ -208,7 +208,7 @@
 	<key>LSFileQuarantineEnabled</key>
 	<true/>
 	<key>LSMinimumSystemVersion</key>
-	<string>10.9.0</string>
+	<string>10.4.0</string>
   <key>NSSupportsAutomaticGraphicsSwitching</key>
   <true/>
   <key>NSPrincipalClass</key>
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/app/macbuild/Contents/MacOS-files.in
--- a/browser/app/macbuild/Contents/MacOS-files.in	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/app/macbuild/Contents/MacOS-files.in	Fri Jan 20 14:37:54 2017 +0000
@@ -1,7 +1,7 @@
 /*.app/***
 /*.dylib
 /certutil
-/firefox-bin
+/waterfox-bin
 /gtest/***
 /pk12util
 /ssltunnel
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/app/module.ver
--- a/browser/app/module.ver	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/app/module.ver	Fri Jan 20 14:37:54 2017 +0000
@@ -1,8 +1,8 @@
-WIN32_MODULE_COMPANYNAME=Mozilla Corporation
-WIN32_MODULE_COPYRIGHT=�Firefox and Mozilla Developers; available under the MPL 2 license.
+WIN32_MODULE_COMPANYNAME=Waterfox
+WIN32_MODULE_COPYRIGHT=Waterfox is © Waterfox Ltd. Not associated with Firefox and Mozilla Developers; available under the MPL 2 license.
 WIN32_MODULE_PRODUCTVERSION=@MOZ_APP_WINVERSION@
 WIN32_MODULE_PRODUCTVERSION_STRING=@MOZ_APP_VERSION@
-WIN32_MODULE_TRADEMARKS=Firefox is a Trademark of The Mozilla Foundation.
+WIN32_MODULE_TRADEMARKS=Waterfox is part of the Waterfox Project. Not associated with Firefox, a Trademark of The Mozilla Foundation.
 WIN32_MODULE_DESCRIPTION=@MOZ_APP_DISPLAYNAME@
 WIN32_MODULE_PRODUCTNAME=@MOZ_APP_DISPLAYNAME@
 WIN32_MODULE_NAME=@MOZ_APP_DISPLAYNAME@
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/app/profile/firefox.js
--- a/browser/app/profile/firefox.js	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/app/profile/firefox.js	Fri Jan 20 14:37:54 2017 +0000
@@ -52,7 +52,7 @@
 
 pref("extensions.update.autoUpdateDefault", true);
 
-pref("extensions.hotfix.id", "firefox-hotfix@mozilla.org");
+pref("extensions.hotfix.id", "");
 pref("extensions.hotfix.cert.checkAttributes", true);
 pref("extensions.hotfix.certs.1.sha1Fingerprint", "91:53:98:0C:C1:86:DF:47:8F:35:22:9E:11:C9:A7:31:04:49:A1:AA");
 pref("extensions.hotfix.certs.2.sha1Fingerprint", "39:E7:2B:7A:5B:CF:37:78:F9:5D:4A:E0:53:2D:2F:3D:68:53:C5:60");
@@ -69,7 +69,7 @@
 pref("extensions.webextensions.default-content-security-policy", "script-src 'self'; object-src 'self';");
 
 // Require signed add-ons by default
-pref("xpinstall.signatures.required", true);
+pref("xpinstall.signatures.required", false);
 pref("xpinstall.signatures.devInfoURL", "https://wiki.mozilla.org/Addons/Extension_Signing");
 
 // Dictionary download preference
@@ -122,20 +122,22 @@
 pref("app.update.silent", false);
 
 // If set to true, the hamburger button will show badges for update events.
-#ifndef RELEASE_BUILD
 pref("app.update.badge", true);
-#else
-pref("app.update.badge", false);
-#endif
 // app.update.badgeWaitTime is in branding section
 
 // If set to true, the Update Service will apply updates in the background
 // when it finishes downloading them.
 pref("app.update.staging.enabled", true);
 
-// Update service URL:
-pref("app.update.url", "https://aus5.mozilla.org/update/6/%PRODUCT%/%VERSION%/%BUILD_ID%/%BUILD_TARGET%/%LOCALE%/%CHANNEL%/%OS_VERSION%/%SYSTEM_CAPABILITIES%/%DISTRIBUTION%/%DISTRIBUTION_VERSION%/update.xml");
-// app.update.url.manual is in branding section
+#ifdef XP_WIN
+pref("app.update.url", "https://www.waterfoxproject.org/update/win64/%VERSION%/%LOCALE%/%CHANNEL%/update.xml");
+#endif
+#ifdef XP_MACOSX
+pref("app.update.url", "https://www.waterfoxproject.org/update/osx64/%VERSION%/%LOCALE%/%CHANNEL%/update.xml");
+#endif
+#ifdef XP_LINUX
+pref("app.update.url", "https://www.waterfoxproject.org/update/linux64/%VERSION%/%LOCALE%/%CHANNEL%/update.xml");
+#endif// app.update.url.manual is in branding section
 // app.update.url.details is in branding section
 
 // User-settable override to app.update.url for testing purposes.
@@ -147,6 +149,13 @@
 // Show the Update Checking/Ready UI when the user was idle for x seconds
 pref("app.update.idletime", 60);
 
+// Whether or not we show a dialog box informing the user that the update was
+// successfully applied. This is off in Firefox by default since we show a
+// upgrade start page instead! Other apps may wish to show this UI, and supply
+// a whatsNewURL field in their brand.properties that contains a link to a page
+// which tells users what's new in this new update.
+//pref("app.update.showInstalledUI", true);
+
 // Whether or not to attempt using the service for updates.
 #ifdef MOZ_MAINTENANCE_SERVICE
 pref("app.update.service.enabled", true);
@@ -176,24 +185,24 @@
 pref("lightweightThemes.recommendedThemes", "[{\"id\":\"recommended-1\",\"homepageURL\":\"https://addons.mozilla.org/firefox/addon/a-web-browser-renaissance/\",\"headerURL\":\"resource:///chrome/browser/content/browser/defaultthemes/1.header.jpg\",\"footerURL\":\"resource:///chrome/browser/content/browser/defaultthemes/1.footer.jpg\",\"textcolor\":\"#000000\",\"accentcolor\":\"#f2d9b1\",\"iconURL\":\"resource:///chrome/browser/content/browser/defaultthemes/1.icon.jpg\",\"previewURL\":\"resource:///chrome/browser/content/browser/defaultthemes/1.preview.jpg\",\"author\":\"Sean.Martell\",\"version\":\"0\"},{\"id\":\"recommended-2\",\"homepageURL\":\"https://addons.mozilla.org/firefox/addon/space-fantasy/\",\"headerURL\":\"resource:///chrome/browser/content/browser/defaultthemes/2.header.jpg\",\"footerURL\":\"resource:///chrome/browser/content/browser/defaultthemes/2.footer.jpg\",\"textcolor\":\"#ffffff\",\"accentcolor\":\"#d9d9d9\",\"iconURL\":\"resource:///chrome/browser/content/browser/defaultthemes/2.icon.jpg\",\"previewURL\":\"resource:///chrome/browser/content/browser/defaultthemes/2.preview.jpg\",\"author\":\"fx5800p\",\"version\":\"1.0\"},{\"id\":\"recommended-3\",\"homepageURL\":\"https://addons.mozilla.org/firefox/addon/linen-light/\",\"headerURL\":\"resource:///chrome/browser/content/browser/defaultthemes/3.header.png\",\"footerURL\":\"resource:///chrome/browser/content/browser/defaultthemes/3.footer.png\",\"accentcolor\":\"#ada8a8\",\"iconURL\":\"resource:///chrome/browser/content/browser/defaultthemes/3.icon.png\",\"previewURL\":\"resource:///chrome/browser/content/browser/defaultthemes/3.preview.png\",\"author\":\"DVemer\",\"version\":\"1.0\"},{\"id\":\"recommended-4\",\"homepageURL\":\"https://addons.mozilla.org/firefox/addon/pastel-gradient/\",\"headerURL\":\"resource:///chrome/browser/content/browser/defaultthemes/4.header.png\",\"footerURL\":\"resource:///chrome/browser/content/browser/defaultthemes/4.footer.png\",\"textcolor\":\"#000000\",\"accentcolor\":\"#000000\",\"iconURL\":\"resource:///chrome/browser/content/browser/defaultthemes/4.icon.png\",\"previewURL\":\"resource:///chrome/browser/content/browser/defaultthemes/4.preview.png\",\"author\":\"darrinhenein\",\"version\":\"1.0\"},{\"id\":\"recommended-5\",\"homepageURL\":\"https://addons.mozilla.org/firefox/addon/carbon-light/\",\"headerURL\":\"resource:///chrome/browser/content/browser/defaultthemes/5.header.png\",\"footerURL\":\"resource:///chrome/browser/content/browser/defaultthemes/5.footer.png\",\"textcolor\":\"#3b3b3b\",\"accentcolor\":\"#2e2e2e\",\"iconURL\":\"resource:///chrome/browser/content/browser/defaultthemes/5.icon.jpg\",\"previewURL\":\"resource:///chrome/browser/content/browser/defaultthemes/5.preview.jpg\",\"author\":\"Jaxivo\",\"version\":\"1.0\"}]");
 
 #if defined(MOZ_ADOBE_EME) || defined(MOZ_WIDEVINE_EME)
-pref("browser.eme.ui.enabled", true);
+pref("browser.eme.ui.enabled", false);
 #else
 pref("browser.eme.ui.enabled", false);
 #endif
 
 // UI tour experience.
-pref("browser.uitour.enabled", true);
+pref("browser.uitour.enabled", false);
 pref("browser.uitour.loglevel", "Error");
 pref("browser.uitour.requireSecure", true);
-pref("browser.uitour.themeOrigin", "https://addons.mozilla.org/%LOCALE%/firefox/themes/");
-pref("browser.uitour.url", "https://www.mozilla.org/%LOCALE%/firefox/%VERSION%/tour/");
+pref("browser.uitour.themeOrigin", "");
+pref("browser.uitour.url", "");
 // This is used as a regexp match against the page's URL.
 pref("browser.uitour.readerViewTrigger", "^https:\\/\\/www\\.mozilla\\.org\\/[^\\/]+\\/firefox\\/reading\\/start");
 // How long to show a Hearbeat survey (two hours, in seconds)
 pref("browser.uitour.surveyDuration", 7200);
 
 pref("browser.customizemode.tip0.shown", false);
-pref("browser.customizemode.tip0.learnMoreUrl", "https://support.mozilla.org/1/firefox/%VERSION%/%OS%/%LOCALE%/customize");
+pref("browser.customizemode.tip0.learnMoreUrl", "");
 
 pref("keyword.enabled", true);
 pref("browser.fixup.domainwhitelist.localhost", true);
@@ -228,14 +237,14 @@
 // Whether we should skip the homepage when opening the first-run page
 pref("browser.startup.firstrunSkipsHomepage", false);
 
-pref("browser.slowStartup.notificationDisabled", false);
+pref("browser.slowStartup.notificationDisabled", true);
 pref("browser.slowStartup.timeThreshold", 40000);
 pref("browser.slowStartup.maxSamples", 5);
 
 // This url, if changed, MUST continue to point to an https url. Pulling arbitrary content to inject into
 // this page over http opens us up to a man-in-the-middle attack that we'd rather not face. If you are a downstream
 // repackager of this code using an alternate snippet url, please keep your users safe
-pref("browser.aboutHomeSnippets.updateUrl", "https://snippets.cdn.mozilla.net/%STARTPAGE_VERSION%/%NAME%/%VERSION%/%APPBUILDID%/%BUILD_TARGET%/%LOCALE%/%CHANNEL%/%OS_VERSION%/%DISTRIBUTION%/%DISTRIBUTION_VERSION%/");
+pref("browser.aboutHomeSnippets.updateUrl", "");
 
 pref("browser.enable_automatic_image_resizing", true);
 pref("browser.casting.enabled", false);
@@ -368,11 +377,11 @@
 // This is disabled globally, and then enabled for individual locales
 // in firefox-l10n.js (eg. it's enabled for en-US).
 pref("browser.search.geoSpecificDefaults", false);
-pref("browser.search.geoSpecificDefaults.url", "https://search.services.mozilla.com/1/%APP%/%VERSION%/%CHANNEL%/%LOCALE%/%REGION%/%DISTRIBUTION%/%DISTRIBUTION_VERSION%");
+pref("browser.search.geoSpecificDefaults.url", "");
 
 // US specific default (used as a fallback if the geoSpecificDefaults request fails).
-pref("browser.search.defaultenginename.US",      "data:text/plain,browser.search.defaultenginename.US=Yahoo");
-pref("browser.search.order.US.1",                "data:text/plain,browser.search.order.US.1=Yahoo");
+pref("browser.search.defaultenginename.US",      "data:text/plain,browser.search.defaultenginename.US=Ecosia");
+pref("browser.search.order.US.1",                "data:text/plain,browser.search.order.US.1=Ecosia");
 pref("browser.search.order.US.2",                "data:text/plain,browser.search.order.US.2=Google");
 pref("browser.search.order.US.3",                "data:text/plain,browser.search.order.US.3=Bing");
 
@@ -787,7 +796,7 @@
 pref("browser.rights.override", true);
 #endif
 
-pref("browser.selfsupport.url", "https://self-repair.mozilla.org/%LOCALE%/repair");
+pref("browser.selfsupport.url", "");
 
 pref("browser.sessionstore.resume_from_crash", true);
 pref("browser.sessionstore.resume_session_once", false);
@@ -893,11 +902,11 @@
 pref("browser.zoom.updateBackgroundTabs", true);
 
 // The breakpad report server to link to in about:crashes
-pref("breakpad.reportURL", "https://crash-stats.mozilla.com/report/index/");
+pref("breakpad.reportURL", "");
 
 // URL for "Learn More" for Crash Reporter
 pref("toolkit.crashreporter.infoURL",
-     "https://www.mozilla.org/legal/privacy/firefox.html#crash-reporter");
+     "");
 
 // base URL for web-based support pages
 pref("app.support.baseURL", "https://support.mozilla.org/1/firefox/%VERSION%/%OS%/%LOCALE%/");
@@ -907,9 +916,9 @@
 
 // base url for web-based feedback pages
 #ifdef MOZ_DEV_EDITION
-pref("app.feedback.baseURL", "https://input.mozilla.org/%LOCALE%/feedback/firefoxdev/%VERSION%/");
+pref("app.feedback.baseURL", "");
 #else
-pref("app.feedback.baseURL", "https://input.mozilla.org/%LOCALE%/feedback/%APP%/%VERSION%/");
+pref("app.feedback.baseURL", "");
 #endif
 
 
@@ -923,7 +932,7 @@
 // bookmarking dialog
 pref("browser.bookmarks.editDialog.firstEditField", "namePicker");
 
-pref("dom.ipc.plugins.flash.disable-protected-mode", false);
+pref("dom.ipc.plugins.flash.disable-protected-mode", true);
 
 // Feature-disable the protected-mode auto-flip
 pref("browser.flash-protected-mode-flip.enable", false);
@@ -957,7 +966,7 @@
 pref("dom.ipc.plugins.sandbox-level.default", 0);
 #if defined(_AMD64_)
 // The lines in PluginModuleParent.cpp should be changed in line with this.
-pref("dom.ipc.plugins.sandbox-level.flash", 2);
+pref("dom.ipc.plugins.sandbox-level.flash", 0);
 #else
 pref("dom.ipc.plugins.sandbox-level.flash", 0);
 #endif
@@ -1180,10 +1189,10 @@
 pref("browser.newtabpage.columns", 5);
 
 // directory tiles download URL
-pref("browser.newtabpage.directory.source", "https://tiles.services.mozilla.com/v3/links/fetch/%LOCALE%/%CHANNEL%");
+pref("browser.newtabpage.directory.source", "");
 
 // endpoint to send newtab click and view pings
-pref("browser.newtabpage.directory.ping", "https://tiles.services.mozilla.com/v3/links/");
+pref("browser.newtabpage.directory.ping", "");
 
 // activates the remote-hosted newtab page
 pref("browser.newtabpage.remote", false);
@@ -1230,7 +1239,7 @@
 // Activation from inside of share panel is possible if activationPanelEnabled
 // is true. Pref'd off for release while usage testing is done through beta.
 pref("social.share.activationPanelEnabled", true);
-pref("social.shareDirectory", "https://activations.cdn.mozilla.net/sharePanel.html");
+pref("social.shareDirectory", "");
 
 // Block insecure active content on https pages
 pref("security.mixed_content.block_active_content", true);
@@ -1250,11 +1259,7 @@
 pref("dom.debug.propagate_gesture_events_through_content", false);
 
 // The request URL of the GeoLocation backend.
-#ifdef RELEASE_BUILD
-pref("geo.wifi.uri", "https://www.googleapis.com/geolocation/v1/geolocate?key=%GOOGLE_API_KEY%");
-#else
 pref("geo.wifi.uri", "https://location.services.mozilla.com/v1/geolocate?key=%MOZILLA_API_KEY%");
-#endif
 
 #ifdef XP_MACOSX
 #ifdef RELEASE_BUILD
@@ -1347,9 +1352,9 @@
 // permission is granted.
 pref("media.eme.enabled", false);
 #else
-pref("media.eme.enabled", true);
+pref("media.eme.enabled", false);
 #endif
-pref("media.eme.apiVisible", true);
+pref("media.eme.apiVisible", false);
 
 // Decode using Gecko Media Plugins in <video>, if a system decoder is not
 // availble and the preferred GMP is available.
@@ -1397,12 +1402,12 @@
 
 // Telemetry settings.
 // Determines if Telemetry pings can be archived locally.
-pref("toolkit.telemetry.archive.enabled", true);
+pref("toolkit.telemetry.archive.enabled", false);
 
 // Telemetry experiments settings.
-pref("experiments.enabled", true);
+pref("experiments.enabled", false);
 pref("experiments.manifest.fetchIntervalSeconds", 86400);
-pref("experiments.manifest.uri", "https://telemetry-experiment.cdn.mozilla.net/manifest/v1/firefox/%VERSION%/%CHANNEL%");
+pref("experiments.manifest.uri", "");
 // Whether experiments are supported by the current application profile.
 pref("experiments.supported", true);
 
@@ -1514,8 +1519,6 @@
 // Enable browser frames for use on desktop.  Only exposed to chrome callers.
 pref("dom.mozBrowserFramesEnabled", true);
 
-pref("extensions.pocket.enabled", true);
-
 pref("signon.schemeUpgrades", true);
 
 // "Simplify Page" feature in Print Preview. This feature is disabled by default
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/base/content/aboutDialog.css
--- a/browser/base/content/aboutDialog.css	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/base/content/aboutDialog.css	Fri Jan 20 14:37:54 2017 +0000
@@ -11,7 +11,7 @@
 }
 
 #rightBox {
-  background-image: url("chrome://branding/content/about-wordmark.svg");
+  background-image: url("chrome://branding/content/about-wordmark.png");
   background-repeat: no-repeat;
   /* padding-top creates room for the wordmark */
   padding-top: 38px;
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/base/content/abouthome/aboutHome.js
--- a/browser/base/content/abouthome/aboutHome.js	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/base/content/abouthome/aboutHome.js	Fri Jan 20 14:37:54 2017 +0000
@@ -10,8 +10,8 @@
 //   * add an entry here in the proper ordering (based on spans)
 // The <a/> part of the snippet will be linked to the corresponding url.
 const DEFAULT_SNIPPETS_URLS = [
-  "https://www.mozilla.org/firefox/features/?utm_source=snippet&utm_medium=snippet&utm_campaign=default+feature+snippet"
-, "https://addons.mozilla.org/firefox/?utm_source=snippet&utm_medium=snippet&utm_campaign=addons"
+  ""
+, ""
 ];
 
 const SNIPPETS_UPDATE_INTERVAL_MS = 14400000; // 4 hours.
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/components/nsBrowserGlue.js
--- a/browser/components/nsBrowserGlue.js	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/components/nsBrowserGlue.js	Fri Jan 20 14:37:54 2017 +0000
@@ -41,6 +41,7 @@
   ["LoginHelper", "resource://gre/modules/LoginHelper.jsm"],
   ["LoginManagerParent", "resource://gre/modules/LoginManagerParent.jsm"],
   ["NetUtil", "resource://gre/modules/NetUtil.jsm"],
+  ["UserAgentOverrides", "resource://gre/modules/UserAgentOverrides.jsm"],
   ["NewTabMessages", "resource:///modules/NewTabMessages.jsm"],
   ["NewTabUtils", "resource://gre/modules/NewTabUtils.jsm"],
   ["OS", "resource://gre/modules/osfile.jsm"],
@@ -672,6 +673,7 @@
     PageThumbs.init();
     webrtcUI.init();
     AboutHome.init();
+    UserAgentOverrides.init();
 
     DirectoryLinksProvider.init();
     NewTabUtils.init();
@@ -1049,6 +1051,7 @@
     webrtcUI.uninit();
     FormValidationHandler.uninit();
     AutoCompletePopup.uninit();
+    UserAgentOverrides.uninit();
     if (AppConstants.NIGHTLY_BUILD) {
       AddonWatcher.uninit();
     }
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/extensions/moz.build
--- a/browser/extensions/moz.build	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/extensions/moz.build	Fri Jan 20 14:37:54 2017 +0000
@@ -6,15 +6,6 @@
 
 DIRS += [
     'aushelper',
-    'e10srollout',
     'pdfjs',
-    'pocket',
     'webcompat',
 ]
-
-# Only include the following system add-ons if building Aurora or Nightly
-if 'a' in CONFIG['GRE_MILESTONE']:
-    DIRS += [
-        'flyweb',
-        'formautofill',
-    ]
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/installer/windows/app.tag
--- a/browser/installer/windows/app.tag	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/installer/windows/app.tag	Fri Jan 20 14:37:54 2017 +0000
@@ -1,4 +1,4 @@
 ;!@Install@!UTF-8!
-Title="Mozilla Firefox"
+Title="Waterfox"
 RunProgram="setup.exe"
 ;!@InstallEnd@!
\ No newline at end of file
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/installer/windows/nsis/installer.nsi
--- a/browser/installer/windows/nsis/installer.nsi	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/installer/windows/nsis/installer.nsi	Fri Jan 20 14:37:54 2017 +0000
@@ -1205,7 +1205,7 @@
 ; The commands inside this ifndef are needed prior to NSIS 3.0a2 and can be
 ; removed after we require NSIS 3.0a2 or greater.
 !ifndef NSIS_PACKEDVERSION
-  ${If} ${AtLeastWinVista}
+  ${If} ${AtLeastWinXP}
     System::Call 'user32::SetProcessDPIAware()'
   ${EndIf}
 !endif
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/installer/windows/nsis/maintenanceservice_installer.nsi
--- a/browser/installer/windows/nsis/maintenanceservice_installer.nsi	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/installer/windows/nsis/maintenanceservice_installer.nsi	Fri Jan 20 14:37:54 2017 +0000
@@ -136,7 +136,7 @@
 ; The commands inside this ifndef are needed prior to NSIS 3.0a2 and can be
 ; removed after we require NSIS 3.0a2 or greater.
 !ifndef NSIS_PACKEDVERSION
-  ${If} ${AtLeastWinVista}
+  ${If} ${AtLeastWinXP}
     System::Call 'user32::SetProcessDPIAware()'
   ${EndIf}
 !endif
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/installer/windows/nsis/shared.nsh
--- a/browser/installer/windows/nsis/shared.nsh	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/installer/windows/nsis/shared.nsh	Fri Jan 20 14:37:54 2017 +0000
@@ -1294,7 +1294,7 @@
 
   ${SetHandlers}
 
-  ${If} ${AtLeastWinVista}
+  ${If} ${AtLeastWinXP}
     ; Only register as the handler on Vista and above if the app registry name
     ; exists under the RegisteredApplications registry key. The protocol and
     ; file handlers set previously at the user level will associate this install
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/installer/windows/nsis/stub.nsi
--- a/browser/installer/windows/nsis/stub.nsi	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/installer/windows/nsis/stub.nsi	Fri Jan 20 14:37:54 2017 +0000
@@ -386,7 +386,7 @@
 ; The commands inside this ifndef are needed prior to NSIS 3.0a2 and can be
 ; removed after we require NSIS 3.0a2 or greater.
 !ifndef NSIS_PACKEDVERSION
-  ${If} ${AtLeastWinVista}
+  ${If} ${AtLeastWinXP}
     System::Call 'user32::SetProcessDPIAware()'
   ${EndIf}
 !endif
@@ -443,7 +443,7 @@
   ${EndIf}
 
   ; The interval in MS used for the progress bars set as marquee.
-  ${If} ${AtLeastWinVista}
+  ${If} ${AtLeastWinXP}
     StrCpy $ProgressbarMarqueeIntervalMS "10"
   ${Else}
     StrCpy $ProgressbarMarqueeIntervalMS "50"
@@ -688,7 +688,7 @@
     ${EndIf}
 
     ${If} "$R2" == "0"
-    ${AndIf} ${AtLeastWinVista}
+    ${AndIf} ${AtLeastWinXP}
       ; Check to see if this install location is currently set as the default
       ; browser by Default Programs which is only available on Vista and above.
       ClearErrors
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/installer/windows/nsis/uninstaller.nsi
--- a/browser/installer/windows/nsis/uninstaller.nsi	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/installer/windows/nsis/uninstaller.nsi	Fri Jan 20 14:37:54 2017 +0000
@@ -610,7 +610,7 @@
 ; The commands inside this ifndef are needed prior to NSIS 3.0a2 and can be
 ; removed after we require NSIS 3.0a2 or greater.
 !ifndef NSIS_PACKEDVERSION
-  ${If} ${AtLeastWinVista}
+  ${If} ${AtLeastWinXP}
     System::Call 'user32::SetProcessDPIAware()'
   ${EndIf}
 !endif
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/locales/Makefile.in
--- a/browser/locales/Makefile.in	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/locales/Makefile.in	Fri Jan 20 14:37:54 2017 +0000
@@ -105,7 +105,6 @@
 	@$(MAKE) -C ../../toolkit/locales libs-$* XPI_ROOT_APPID='$(XPI_ROOT_APPID)'
 	@$(MAKE) -C ../../services/sync/locales AB_CD=$* XPI_NAME=locale-$*
 	@$(MAKE) -C ../../extensions/spellcheck/locales AB_CD=$* XPI_NAME=locale-$*
-	@$(MAKE) -C ../extensions/pocket/locale AB_CD=$* XPI_NAME=locale-$*
 	@$(MAKE) -C ../../intl/locales AB_CD=$* XPI_NAME=locale-$*
 	@$(MAKE) -C ../../devtools/client/locales AB_CD=$* XPI_NAME=locale-$* XPI_ROOT_APPID='$(XPI_ROOT_APPID)'
 	@$(MAKE) -B searchplugins AB_CD=$* XPI_NAME=locale-$*
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/locales/en-US/chrome/browser-region/region.properties
--- a/browser/locales/en-US/chrome/browser-region/region.properties	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/locales/en-US/chrome/browser-region/region.properties	Fri Jan 20 14:37:54 2017 +0000
@@ -3,11 +3,11 @@
 # file, You can obtain one at http://mozilla.org/MPL/2.0/.
 
 # Default search engine
-browser.search.defaultenginename=Google
+browser.search.defaultenginename=Ecosia
 
 # Search engine order (order displayed in the search bar dropdown)s
-browser.search.order.1=Google
-browser.search.order.2=Yahoo
+browser.search.order.1=Ecosia
+browser.search.order.2=Google
 browser.search.order.3=Bing
 
 # This is the default set of web based feed handlers shown in the reader
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/locales/en-US/firefox-l10n.js
--- a/browser/locales/en-US/firefox-l10n.js	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/locales/en-US/firefox-l10n.js	Fri Jan 20 14:37:54 2017 +0000
@@ -6,6 +6,6 @@
 
 # LOCALIZATION NOTE: this preference is set to true for en-US specifically,
 # locales without this line have the setting set to false by default.
-pref("browser.search.geoSpecificDefaults", true);
+pref("browser.search.geoSpecificDefaults", false);
 
 pref("general.useragent.locale", "@AB_CD@");
diff -r 9a5e1a8c8ebb -r 4bef188995a7 browser/locales/en-US/searchplugins/list.txt
--- a/browser/locales/en-US/searchplugins/list.txt	Fri Jan 20 03:08:48 2017 -0800
+++ b/browser/locales/en-US/searchplugins/list.txt	Fri Jan 20 14:37:54 2017 +0000
@@ -1,7 +1,8 @@
-amazondotcom
 bing
+ddg
+disconnect
+ecosia
 google
-twitter
 wikipedia
-yahoo
-yahoo-en-CA:hidden
+startpage
+yahoo
\ No newline at end of file
diff -r 9a5e1a8c8ebb -r 4bef188995a7 config/version_win.pl
--- a/config/version_win.pl	Fri Jan 20 03:08:48 2017 -0800
+++ b/config/version_win.pl	Fri Jan 20 14:37:54 2017 +0000
@@ -235,8 +235,8 @@
 my $winappversion = "$appver[0],$appver[1],$appver[2],$appver[3]";
 
 my $copyright = "License: MPL 2";
-my $company = "Mozilla Foundation";
-my $trademarks = "Mozilla";
+my $company = "Waterfox Ltd";
+my $trademarks = "Waterfox";
 my $productname = $displayname;
 
 
diff -r 9a5e1a8c8ebb -r 4bef188995a7 dom/plugins/base/nsPluginHost.cpp
--- a/dom/plugins/base/nsPluginHost.cpp	Fri Jan 20 03:08:48 2017 -0800
+++ b/dom/plugins/base/nsPluginHost.cpp	Fri Jan 20 14:37:54 2017 +0000
@@ -2042,34 +2042,8 @@
 bool
 nsPluginHost::ShouldAddPlugin(nsPluginTag* aPluginTag)
 {
-#if defined(XP_WIN) && (defined(__x86_64__) || defined(_M_X64))
-  // On 64-bit windows, the only plugins we should load are flash and
-  // silverlight. Use library filename and MIME type to check.
-  if (StringBeginsWith(aPluginTag->FileName(), NS_LITERAL_CSTRING("NPSWF"), nsCaseInsensitiveCStringComparator()) &&
-      (aPluginTag->HasMimeType(NS_LITERAL_CSTRING("application/x-shockwave-flash")) ||
-       aPluginTag->HasMimeType(NS_LITERAL_CSTRING("application/x-shockwave-flash-test")))) {
-    return true;
-  }
-  if (StringBeginsWith(aPluginTag->FileName(), NS_LITERAL_CSTRING("npctrl"), nsCaseInsensitiveCStringComparator()) &&
-      (aPluginTag->HasMimeType(NS_LITERAL_CSTRING("application/x-silverlight-test")) ||
-       aPluginTag->HasMimeType(NS_LITERAL_CSTRING("application/x-silverlight-2")) ||
-       aPluginTag->HasMimeType(NS_LITERAL_CSTRING("application/x-silverlight")))) {
-    return true;
-  }
-  // Accept the test plugin MIME types, so mochitests still work.
-  if (aPluginTag->HasMimeType(NS_LITERAL_CSTRING("application/x-test")) ||
-      aPluginTag->HasMimeType(NS_LITERAL_CSTRING("application/x-Second-Test")) ||
-      aPluginTag->HasMimeType(NS_LITERAL_CSTRING("application/x-java-test"))) {
-    return true;
-  }
-#ifdef PLUGIN_LOGGING
-  PLUGIN_LOG(PLUGIN_LOG_NORMAL,
-             ("ShouldAddPlugin : Ignoring non-flash plugin library %s\n", aPluginTag->FileName().get()));
-#endif // PLUGIN_LOGGING
-  return false;
-#else
+// allow all plugins to run
   return true;
-#endif // defined(XP_WIN) && (defined(__x86_64__) || defined(_M_X64))
 }
 
 void
diff -r 9a5e1a8c8ebb -r 4bef188995a7 dom/plugins/ipc/hangui/module.ver
--- a/dom/plugins/ipc/hangui/module.ver	Fri Jan 20 03:08:48 2017 -0800
+++ b/dom/plugins/ipc/hangui/module.ver	Fri Jan 20 14:37:54 2017 +0000
@@ -1,4 +1,4 @@
-WIN32_MODULE_COMPANYNAME=Mozilla Corporation
+WIN32_MODULE_COMPANYNAME=Waterfox Ltd
 WIN32_MODULE_PRODUCTVERSION=@MOZ_APP_WINVERSION@
 WIN32_MODULE_PRODUCTVERSION_STRING=@MOZ_APP_VERSION@
 WIN32_MODULE_DESCRIPTION=Plugin Hang UI for @MOZ_APP_DISPLAYNAME@
diff -r 9a5e1a8c8ebb -r 4bef188995a7 ipc/app/module.ver
--- a/ipc/app/module.ver	Fri Jan 20 03:08:48 2017 -0800
+++ b/ipc/app/module.ver	Fri Jan 20 14:37:54 2017 +0000
@@ -1,4 +1,4 @@
-WIN32_MODULE_COMPANYNAME=Mozilla Corporation
+WIN32_MODULE_COMPANYNAME=Waterfox Ltd
 WIN32_MODULE_PRODUCTVERSION=@MOZ_APP_WINVERSION@
 WIN32_MODULE_PRODUCTVERSION_STRING=@MOZ_APP_VERSION@
 WIN32_MODULE_DESCRIPTION=Plugin Container for @MOZ_APP_DISPLAYNAME@
diff -r 9a5e1a8c8ebb -r 4bef188995a7 js/src/old-configure.in
--- a/js/src/old-configure.in	Fri Jan 20 03:08:48 2017 -0800
+++ b/js/src/old-configure.in	Fri Jan 20 14:37:54 2017 +0000
@@ -725,7 +725,7 @@
         if test "$CPU_ARCH" = "x86"; then
             WIN32_SUBSYSTEM_VERSION=5.01
         else
-            WIN32_SUBSYSTEM_VERSION=6.01
+            WIN32_SUBSYSTEM_VERSION=5.02
         fi
         WIN32_CONSOLE_EXE_LDFLAGS=-SUBSYSTEM:CONSOLE,$WIN32_SUBSYSTEM_VERSION
         WIN32_GUI_EXE_LDFLAGS=-SUBSYSTEM:WINDOWS,$WIN32_SUBSYSTEM_VERSION
diff -r 9a5e1a8c8ebb -r 4bef188995a7 modules/libpref/init/all.js
--- a/modules/libpref/init/all.js	Fri Jan 20 03:08:48 2017 -0800
+++ b/modules/libpref/init/all.js	Fri Jan 20 14:37:54 2017 +0000
@@ -21,11 +21,15 @@
 
 pref("keyword.enabled", false);
 pref("general.useragent.locale", "chrome://global/locale/intl.properties");
-pref("general.useragent.compatMode.firefox", false);
+pref("general.useragent.compatMode.firefox", true);
 
 // This pref exists only for testing purposes. In order to disable all
 // overrides by default, don't initialize UserAgentOverrides.jsm.
 pref("general.useragent.site_specific_overrides", true);
+pref("general.useragent.override.netflix.com", "Mozilla/5.0 (Windows NT 10.0; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0");
+pref("general.useragent.override.chase.com", "Mozilla/5.0 (Windows NT 10.0; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0");
+pref("general.useragent.override.amazon.com", "Mozilla/5.0 (Windows NT 10.0; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0");
+pref("general.useragent.override.amazon.co.uk", "Mozilla/5.0 (Windows NT 10.0; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0");
 
 pref("general.config.obscure_value", 13); // for MCD .cfg files
 
@@ -548,10 +552,10 @@
 pref("media.getusermedia.audiocapture.enabled", false);
 
 // TextTrack WebVTT Region extension support.
-pref("media.webvtt.regions.enabled", false);
+pref("media.webvtt.regions.enabled", true);
 
 // AudioTrack and VideoTrack support
-pref("media.track.enabled", false);
+pref("media.track.enabled", true);
 
 // Whether to enable MediaSource support.
 pref("media.mediasource.enabled", true);
@@ -575,8 +579,8 @@
 pref("media.benchmark.timeout", 1000);
 
 #ifdef MOZ_WEBSPEECH
-pref("media.webspeech.recognition.enable", false);
-pref("media.webspeech.synth.enabled", false);
+pref("media.webspeech.recognition.enable", true);
+pref("media.webspeech.synth.enabled", true);
 #endif
 #ifdef MOZ_WEBM_ENCODER
 pref("media.encoder.webm.enabled", true);
@@ -822,8 +826,8 @@
 
 // provide ability to turn on support for canvas focus rings
 pref("canvas.focusring.enabled", true);
-pref("canvas.customfocusring.enabled", false);
-pref("canvas.hitregions.enabled", false);
+pref("canvas.customfocusring.enabled", true);
+pref("canvas.hitregions.enabled", true);
 pref("canvas.filters.enabled", true);
 // Add support for canvas path objects
 pref("canvas.path.enabled", true);
@@ -912,7 +916,7 @@
 
 // Telemetry settings.
 // Server to submit telemetry pings to.
-pref("toolkit.telemetry.server", "https://incoming.telemetry.mozilla.org");
+pref("toolkit.telemetry.server", "");
 // Telemetry server owner. Please change if you set toolkit.telemetry.server to a different server
 pref("toolkit.telemetry.server_owner", "Mozilla");
 // Information page about telemetry (temporary ; will be about:telemetry in the end)
@@ -1163,7 +1167,7 @@
 pref("dom.min_background_timeout_value", 1000);
 
 // Don't use new input types
-pref("dom.experimental_forms", false);
+pref("dom.experimental_forms", true);
 
 // Enable <input type=number>:
 pref("dom.forms.number", true);
@@ -2166,7 +2170,7 @@
 pref("security.view-source.reachable-from-inner-protocol", false);
 
 // Services security settings
-pref("services.settings.server", "https://firefox.settings.services.mozilla.com/v1");
+pref("services.settings.server", "");
 
 // Blocklist preferences
 pref("extensions.blocklist.enabled", true);
@@ -2811,7 +2815,7 @@
 pref("dom.ipc.tabs.shutdownTimeoutSecs", 0);
 #endif
 
-pref("dom.ipc.plugins.flash.disable-protected-mode", false);
+pref("dom.ipc.plugins.flash.disable-protected-mode", true);
 
 pref("dom.ipc.plugins.flash.subprocess.crashreporter.enabled", true);
 pref("dom.ipc.plugins.reportCrashURL", true);
@@ -4672,7 +4676,7 @@
 pref("browser.meta_refresh_when_inactive.disabled", false);
 
 // XPInstall prefs
-pref("xpinstall.whitelist.required", true);
+pref("xpinstall.whitelist.required", false);
 // Only Firefox requires add-on signatures
 pref("xpinstall.signatures.required", false);
 pref("extensions.alwaysUnpack", false);
@@ -4772,7 +4776,7 @@
 
 pref("dom.push.loglevel", "error");
 
-pref("dom.push.serverURL", "wss://push.services.mozilla.com/");
+pref("dom.push.serverURL", "");
 pref("dom.push.userAgentID", "");
 
 // The maximum number of push messages that a service worker can receive
@@ -4827,10 +4831,10 @@
 #endif
 
 // W3C draft pointer events
-pref("dom.w3c_pointer_events.enabled", false);
+pref("dom.w3c_pointer_events.enabled", true);
 
 // W3C draft ImageCapture API
-pref("dom.imagecapture.enabled", false);
+pref("dom.imagecapture.enabled", true);
 
 // W3C MediaDevices devicechange event
 pref("media.ondevicechange.enabled", false);
@@ -5050,7 +5054,7 @@
 pref("captivedetect.maxRetryCount", 5);
 
 #ifdef RELEASE_BUILD
-pref("dom.forms.inputmode", false);
+pref("dom.forms.inputmode", true);
 #else
 pref("dom.forms.inputmode", true);
 #endif
diff -r 9a5e1a8c8ebb -r 4bef188995a7 netwerk/protocol/http/nsHttpHandler.cpp
--- a/netwerk/protocol/http/nsHttpHandler.cpp	Fri Jan 20 03:08:48 2017 -0800
+++ b/netwerk/protocol/http/nsHttpHandler.cpp	Fri Jan 20 14:37:54 2017 +0000
@@ -320,7 +320,7 @@
 
     mMisc.AssignLiteral("rv:" MOZILLA_UAVERSION);
 
-    mCompatFirefox.AssignLiteral("Firefox/" MOZILLA_UAVERSION);
+    mCompatFirefox.AssignLiteral("Waterfox/" MOZ_APP_UA_VERSION);
 
     nsCOMPtr<nsIXULAppInfo> appInfo =
         do_GetService("@mozilla.org/xre/app-info;1");
@@ -719,19 +719,16 @@
     mUserAgent += '/';
     mUserAgent += mProductSub;
 
-    bool isFirefox = mAppName.EqualsLiteral("Firefox");
+    bool isFirefox = mAppName.EqualsLiteral("Waterfox");
     if (isFirefox || mCompatFirefoxEnabled) {
-        // "Firefox/x.y" (compatibility) app token
+        // App portion
+        mUserAgent += ' ';
+        mUserAgent += "Firefox";
+        mUserAgent += '/';
+        mUserAgent += mAppVersion;
         mUserAgent += ' ';
         mUserAgent += mCompatFirefox;
     }
-    if (!isFirefox) {
-        // App portion
-        mUserAgent += ' ';
-        mUserAgent += mAppName;
-        mUserAgent += '/';
-        mUserAgent += mAppVersion;
-    }
 }
 
 #ifdef XP_WIN
diff -r 9a5e1a8c8ebb -r 4bef188995a7 old-configure.in
--- a/old-configure.in	Fri Jan 20 03:08:48 2017 -0800
+++ b/old-configure.in	Fri Jan 20 14:37:54 2017 +0000
@@ -1060,7 +1060,7 @@
         if test "$CPU_ARCH" = "x86"; then
             WIN32_SUBSYSTEM_VERSION=5.01
         else
-            WIN32_SUBSYSTEM_VERSION=6.01
+            WIN32_SUBSYSTEM_VERSION=5.02
         fi
         WIN32_CONSOLE_EXE_LDFLAGS=-SUBSYSTEM:CONSOLE,$WIN32_SUBSYSTEM_VERSION
         WIN32_GUI_EXE_LDFLAGS=-SUBSYSTEM:WINDOWS,$WIN32_SUBSYSTEM_VERSION
@@ -5708,23 +5708,23 @@
 AC_SUBST(MOZ_SOURCE_CHANGESET)
 AC_SUBST(MOZ_INCLUDE_SOURCE_INFO)
 
-if test "$MOZ_TELEMETRY_REPORTING"; then
-    AC_DEFINE(MOZ_TELEMETRY_REPORTING)
-
-    # Enable Telemetry by default for nightly and aurora channels
-    if test -z "$RELEASE_BUILD"; then
-      AC_DEFINE(MOZ_TELEMETRY_ON_BY_DEFAULT)
-    fi
-fi
+dnl if test "$MOZ_TELEMETRY_REPORTING"; then
+dnl AC_DEFINE(MOZ_TELEMETRY_REPORTING)
+
+dnl     # Enable Telemetry by default for nightly and aurora channels
+dnl     if test -z "$RELEASE_BUILD"; then
+dnl       AC_DEFINE(MOZ_TELEMETRY_ON_BY_DEFAULT)
+dnl     fi
+dnl fi
 
 dnl If we have any service that uploads data (and requires data submission
 dnl policy alert), set MOZ_DATA_REPORTING.
 dnl We need SUBST for build system and DEFINE for xul preprocessor.
-if test -n "$MOZ_TELEMETRY_REPORTING" || test -n "$MOZ_SERVICES_HEALTHREPORT" || test -n "$MOZ_CRASHREPORTER"; then
-  MOZ_DATA_REPORTING=1
-  AC_DEFINE(MOZ_DATA_REPORTING)
-  AC_SUBST(MOZ_DATA_REPORTING)
-fi
+dnl if test -n "$MOZ_TELEMETRY_REPORTING" || test -n "$MOZ_SERVICES_HEALTHREPORT" || test -n "$MOZ_CRASHREPORTER"; then
+dnl   MOZ_DATA_REPORTING=1
+dnl   AC_DEFINE(MOZ_DATA_REPORTING)
+dnl   AC_SUBST(MOZ_DATA_REPORTING)
+dnl fi
 
 dnl win32 options
 AC_SUBST(WIN32_REDIST_DIR)
diff -r 9a5e1a8c8ebb -r 4bef188995a7 toolkit/components/maintenanceservice/bootstrapinstaller/maintenanceservice_installer.nsi
--- a/toolkit/components/maintenanceservice/bootstrapinstaller/maintenanceservice_installer.nsi	Fri Jan 20 03:08:48 2017 -0800
+++ b/toolkit/components/maintenanceservice/bootstrapinstaller/maintenanceservice_installer.nsi	Fri Jan 20 14:37:54 2017 +0000
@@ -133,7 +133,7 @@
 ; The commands inside this ifndef are needed prior to NSIS 3.0a2 and can be
 ; removed after we require NSIS 3.0a2 or greater.
 !ifndef NSIS_PACKEDVERSION
-  ${If} ${AtLeastWinVista}
+  ${If} ${AtLeastWinXP}
     System::Call 'user32::SetProcessDPIAware()'
   ${EndIf}
 !endif
diff -r 9a5e1a8c8ebb -r 4bef188995a7 toolkit/mozapps/installer/windows/nsis/common.nsh
--- a/toolkit/mozapps/installer/windows/nsis/common.nsh	Fri Jan 20 03:08:48 2017 -0800
+++ b/toolkit/mozapps/installer/windows/nsis/common.nsh	Fri Jan 20 14:37:54 2017 +0000
@@ -5870,7 +5870,7 @@
       Push $0
 
 !ifndef NONADMIN_ELEVATE
-        ${If} ${AtLeastWinVista}
+        ${If} ${AtLeastWinXP}
           UAC::IsAdmin
           ; If the user is not an admin already
           ${If} "$0" != "1"
@@ -5901,7 +5901,7 @@
           ${EndIf}
         ${EndIf}
 !else
-      ${If} ${AtLeastWinVista}
+      ${If} ${AtLeastWinXP}
         UAC::IsAdmin
         ; If the user is not an admin already
         ${If} "$0" != "1"
@@ -6014,7 +6014,7 @@
     !define ${_MOZFUNC_UN}UnloadUAC "!insertmacro ${_MOZFUNC_UN}UnloadUACCall"
 
     Function ${_MOZFUNC_UN}UnloadUAC
-      ${Unless} ${AtLeastWinVista}
+      ${Unless} ${AtLeastWinXP}
         Return
       ${EndUnless}
 
@@ -6669,7 +6669,7 @@
     !define ${_MOZFUNC_UN}SetAppLSPCategories "!insertmacro ${_MOZFUNC_UN}SetAppLSPCategoriesCall"
 
     Function ${_MOZFUNC_UN}SetAppLSPCategories
-      ${Unless} ${AtLeastWinVista}
+      ${Unless} ${AtLeastWinXP}
         Return
       ${EndUnless}
 
